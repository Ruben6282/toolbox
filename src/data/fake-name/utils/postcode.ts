import { rand } from "./random";
import { CountryCode } from "../country-codes";

// Helpers
const digits = (len: number) =>
  Math.floor(rand() * Math.pow(10, len))
    .toString()
    .padStart(len, "0");

const letters = (len: number) => {
  const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  return Array.from({ length: len }, () => chars[Math.floor(rand() * chars.length)]).join("");
};

export const generatePostcode = (country: CountryCode): string => {
  switch (country) {
    // -------------------------------------------------------------------------
    // ğŸ‡ºğŸ‡¸ USA â€” 5 digits
    // -------------------------------------------------------------------------
    case "us":
      return digits(5);

    // -------------------------------------------------------------------------
    // ğŸ‡¨ğŸ‡¦ Canada â€” A1A 1A1
    // -------------------------------------------------------------------------
    case "ca": {
      const L = "ABCEGHJKLMNPRSTVWXYZ";
      const D = "0123456789";
      const rL = () => L[Math.floor(rand() * L.length)];
      const rD = () => D[Math.floor(rand() * D.length)];
      return `${rL()}${rD()}${rL()} ${rD()}${rL()}${rD()}`;
    }

    // -------------------------------------------------------------------------
    // ğŸ‡¬ğŸ‡§ United Kingdom â€” realistic simplified variants
    // -------------------------------------------------------------------------
    case "uk": {
      // Patterns: A9 9AA, A99 9AA, AA9 9AA, AA99 9AA
      const area = letters(1 + Math.floor(rand() * 2)); // A or AA
      const district = digits(1 + Math.floor(rand() * 1)); // 1 or 2 digits
      const sector = digits(1);
      const unit = letters(2);
      return `${area}${district} ${sector}${unit}`;
    }

    // -------------------------------------------------------------------------
    // ğŸ‡®ğŸ‡ª Ireland â€” Eircode (simplified)
    // Format: A65 F4E2
    // -------------------------------------------------------------------------
    case "ie": {
      return `${letters(1)}${digits(2)} ${letters(1)}${digits(1)}${letters(1)}${digits(1)}`;
    }

    // -------------------------------------------------------------------------
    // ğŸ‡©ğŸ‡ª Germany â€” 5 digits
    // ğŸ‡«ğŸ‡· France â€” 5 digits
    // ğŸ‡ªğŸ‡¸ Spain â€” 5 digits
    // ğŸ‡®ğŸ‡¹ Italy â€” 5 digits
    // ğŸ‡³ğŸ‡± Netherlands â€” 1234 AB
    // ğŸ‡§ğŸ‡ª Belgium â€” 4 digits
    // ğŸ‡µğŸ‡± Poland â€” 00-000
    // -------------------------------------------------------------------------
    case "de":
    case "fr":
    case "es":
    case "it":
      return digits(5);

    case "nl":
      return `${digits(4)} ${letters(2)}`;

    case "be":
      return digits(4);

    case "pl":
      return `${digits(2)}-${digits(3)}`;

    // -------------------------------------------------------------------------
    // Nordics
    // ğŸ‡¸ğŸ‡ª Sweden â€” 123 45
    // ğŸ‡³ğŸ‡´ Norway â€” 4 digits
    // ğŸ‡©ğŸ‡° Denmark â€” 4 digits
    // ğŸ‡«ğŸ‡® Finland â€” 5 digits
    // -------------------------------------------------------------------------
    case "se":
      return `${digits(3)} ${digits(2)}`;

    case "no":
      return digits(4);

    case "dk":
      return digits(4);

    case "fi":
      return digits(5);

    // -------------------------------------------------------------------------
    // ğŸ‡¦ğŸ‡º Australia â€” 4 digits
    // ğŸ‡³ğŸ‡¿ New Zealand â€” 4 digits
    // -------------------------------------------------------------------------
    case "au":
    case "nz":
      return digits(4);

    // -------------------------------------------------------------------------
    // ğŸ‡®ğŸ‡³ India â€” 6-digit PIN
    // -------------------------------------------------------------------------
    case "in":
      return digits(6);

    // -------------------------------------------------------------------------
    // ğŸ‡¿ğŸ‡¦ South Africa â€” 4 digits
    // -------------------------------------------------------------------------
    case "za":
      return digits(4);

    // -------------------------------------------------------------------------
    // ğŸ‡§ğŸ‡· Brazil â€” 00000-000
    // -------------------------------------------------------------------------
    case "br":
      return `${digits(5)}-${digits(3)}`;

    // -------------------------------------------------------------------------
    // ğŸ‡¯ğŸ‡µ Japan â€” 123-4567
    // -------------------------------------------------------------------------
    case "jp":
      return `${digits(3)}-${digits(4)}`;

    // -------------------------------------------------------------------------
    // ğŸ‡²ğŸ‡½ Mexico â€” 5 digits
    // -------------------------------------------------------------------------
    case "mx":
      return digits(5);

    // -------------------------------------------------------------------------
    // ğŸ‡µğŸ‡¹ Portugal â€” 1234-567
    // -------------------------------------------------------------------------
    case "pt":
      return `${digits(4)}-${digits(3)}`;

    // -------------------------------------------------------------------------
    // ğŸ‡°ğŸ‡· South Korea â€” 5 digits
    // -------------------------------------------------------------------------
    case "kr":
      return digits(5);

    // -------------------------------------------------------------------------
    // ğŸ‡·ğŸ‡º Russia â€” 6 digits
    // -------------------------------------------------------------------------
    case "ru":
      return digits(6);

    // -------------------------------------------------------------------------
    // ğŸ‡¨ğŸ‡³ China â€” 6 digits
    // -------------------------------------------------------------------------
    case "cn":
      return digits(6);

    // -------------------------------------------------------------------------
    // Fallback (should never happen)
    // -------------------------------------------------------------------------
    default:
      return digits(5);
  }
};
